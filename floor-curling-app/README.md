# åœ°å£ºçƒå¹³å° - Floor Curling Platform

ä¸€ä¸ªå®Œæ•´çš„åœ°å£ºçƒç®¡ç†å¹³å°ï¼Œä½¿ç”¨ Next.js 15 (App Router) + Supabase + TypeScript + Tailwind CSS æ„å»ºã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ” èº«ä»½éªŒè¯ç³»ç»Ÿ
- **åŒç™»å½•æ¨¡å¼**
  - å‘˜å·¥ç™»å½•ï¼ˆé‚®ç®± + å¯†ç ï¼‰- è¯å¸ˆå’Œç®¡ç†å‘˜
  - å®¶å±ç™»å½•ï¼ˆMagic Link æ— å¯†ç ç™»å½•ï¼‰
- **è§’è‰²æƒé™ç®¡ç†**
  - Adminï¼ˆç®¡ç†å‘˜ï¼‰- å®Œæ•´ç³»ç»Ÿæƒé™
  - Pharmacistï¼ˆè¯å¸ˆï¼‰- åˆ›å»ºæ¯”èµ›ã€ç®¡ç†åº“å­˜
  - Familyï¼ˆå®¶å±ï¼‰- æŸ¥çœ‹å…³è”é•¿è€…çš„æ•°æ®
  - Elderï¼ˆé•¿è€…ï¼‰- å‚ä¸æ¯”èµ›

### ğŸ›¡ï¸ Middleware ä¿æŠ¤
- `/pharmacist/*` è·¯ç”±åªå…è®¸è¯å¸ˆå’Œç®¡ç†å‘˜è®¿é—®
- `/family/*` è·¯ç”±åªå…è®¸å®¶å±è®¿é—®
- æœªç™»å½•ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µ
- åŸºäºè§’è‰²çš„åŠ¨æ€é‡å®šå‘

### ğŸ“± ç”¨æˆ·ç•Œé¢
- **ä¸“ä¸šæ·±è‰²/è“è‰²ä¸»é¢˜**
- **å“åº”å¼è®¾è®¡** - æ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **ç°ä»£åŒ– UI ç»„ä»¶**
- **æµç•…çš„åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ**

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- npm æˆ– yarn
- Supabase è´¦æˆ·

### 1. ç¯å¢ƒé…ç½®

åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```bash
cp .env.example .env.local
```

åœ¨ `.env.local` ä¸­å¡«å…¥æ‚¨çš„ Supabase å‡­æ®ï¼š

```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
# æˆ–
yarn install
```

### 3. è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
npm run dev
# æˆ–
yarn dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
floor-curling-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ globals.css              # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ layout.tsx               # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx                 # é¦–é¡µï¼ˆé‡å®šå‘åˆ°ç™»å½•ï¼‰
â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ page.tsx             # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â””â”€â”€ callback/
â”‚   â”‚       â””â”€â”€ route.ts         # Auth å›è°ƒå¤„ç†
â”‚   â”œâ”€â”€ pharmacist/
â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”‚       â””â”€â”€ page.tsx         # è¯å¸ˆä»ªè¡¨æ¿
â”‚   â””â”€â”€ family/
â”‚       â””â”€â”€ portal/
â”‚           â””â”€â”€ page.tsx         # å®¶å±é—¨æˆ·
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ supabase.ts              # Supabase å®¢æˆ·ç«¯é…ç½®
â”œâ”€â”€ middleware.ts                # è·¯ç”±ä¿æŠ¤ä¸­é—´ä»¶
â”œâ”€â”€ tailwind.config.ts           # Tailwind é…ç½®
â”œâ”€â”€ tsconfig.json                # TypeScript é…ç½®
â”œâ”€â”€ next.config.ts               # Next.js é…ç½®
â””â”€â”€ package.json                 # ä¾èµ–é…ç½®
```

## ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### ç™»å½•é¡µé¢ (`app/login/page.tsx`)

#### å‘˜å·¥ç™»å½•
- ä½¿ç”¨é‚®ç®±å’Œå¯†ç ç™»å½•
- éªŒè¯ç”¨æˆ·è§’è‰²ï¼ˆä»…å…è®¸è¯å¸ˆå’Œç®¡ç†å‘˜ï¼‰
- ç™»å½•æˆåŠŸåé‡å®šå‘åˆ° `/pharmacist/dashboard`

#### å®¶å±ç™»å½•
- ä½¿ç”¨ Magic Linkï¼ˆæ— å¯†ç ï¼‰
- ç³»ç»Ÿå‘é€ç™»å½•é“¾æ¥åˆ°é‚®ç®±
- ç‚¹å‡»é“¾æ¥åé€šè¿‡å›è°ƒå¤„ç†ç™»å½•
- é‡å®šå‘åˆ° `/family/portal`

### Middleware (`middleware.ts`)

```typescript
// ä¿æŠ¤çš„è·¯ç”±
matcher: [
  '/pharmacist/:path*',  // ä»…è¯å¸ˆ/ç®¡ç†å‘˜
  '/family/:path*',      // ä»…å®¶å±
]
```

#### å·¥ä½œæµç¨‹
1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
2. ä» Supabase è·å–ç”¨æˆ·è§’è‰²
3. æ ¹æ®è·¯ç”±å’Œè§’è‰²åˆ¤æ–­è®¿é—®æƒé™
4. æœªæˆæƒåˆ™é‡å®šå‘åˆ°ç™»å½•é¡µ

### Auth å›è°ƒ (`app/auth/callback/route.ts`)

å¤„ç† Magic Link ç™»å½•ï¼š
1. æ¥æ”¶æ¥è‡ªé‚®ç®±çš„ code
2. äº¤æ¢ code è·å– session
3. æ£€æŸ¥ç”¨æˆ·è§’è‰²
4. é‡å®šå‘åˆ°å¯¹åº”çš„é—¨æˆ·

## ğŸ¨ UI ç»„ä»¶ç‰¹æ€§

### ç™»å½•é¡µé¢
- âœ… æ ‡ç­¾é¡µåˆ‡æ¢åŠ¨ç”»
- âœ… è¡¨å•éªŒè¯å’Œé”™è¯¯æç¤º
- âœ… åŠ è½½çŠ¶æ€æ˜¾ç¤º
- âœ… æˆåŠŸ/å¤±è´¥æ¶ˆæ¯æç¤º
- âœ… å“åº”å¼å¸ƒå±€

### è¯å¸ˆä»ªè¡¨æ¿
- âœ… å¡ç‰‡å¼åŠŸèƒ½æ¨¡å—
- âœ… å¿«é€Ÿç»Ÿè®¡æ¦‚è§ˆ
- âœ… å¯¼èˆªæ å’Œç™»å‡ºåŠŸèƒ½
- âœ… Hover äº¤äº’æ•ˆæœ

### å®¶å±é—¨æˆ·
- âœ… æŸ¥çœ‹å…³è”é•¿è€…ä¿¡æ¯
- âœ… æ¯”èµ›è®°å½•è®¿é—®
- âœ… ç…§ç‰‡å’Œè§†é¢‘æµè§ˆ
- âœ… æœªå…³è”æç¤º

## ğŸ” å®‰å…¨ç‰¹æ€§

1. **ç¯å¢ƒå˜é‡ä¿æŠ¤**
   - API å¯†é’¥å­˜å‚¨åœ¨ `.env.local`
   - ä¸ä¼šæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

2. **Row Level Security (RLS)**
   - æ•°æ®åº“å±‚é¢çš„æƒé™æ§åˆ¶
   - ç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®æˆæƒæ•°æ®

3. **Middleware è·¯ç”±ä¿æŠ¤**
   - é˜²æ­¢æœªæˆæƒè®¿é—®
   - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶

4. **å®‰å…¨çš„ Magic Link**
   - ä¸€æ¬¡æ€§ä½¿ç”¨çš„ç™»å½•é“¾æ¥
   - è‡ªåŠ¨è¿‡æœŸæœºåˆ¶

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°è·¯ç”±

1. åœ¨ `app/` ç›®å½•ä¸‹åˆ›å»ºæ–°æ–‡ä»¶å¤¹
2. æ·»åŠ  `page.tsx` æ–‡ä»¶
3. å¦‚éœ€ä¿æŠ¤ï¼Œåœ¨ `middleware.ts` ä¸­æ·»åŠ è·¯ç”±

### è‡ªå®šä¹‰æ ·å¼

ç¼–è¾‘ `tailwind.config.ts` æ·»åŠ è‡ªå®šä¹‰é¢œè‰²æˆ–ä¸»é¢˜ï¼š

```typescript
theme: {
  extend: {
    colors: {
      primary: '#your-color',
    },
  },
},
```

### æ·»åŠ  Supabase æŸ¥è¯¢

```typescript
const { data, error } = await supabase
  .from('table_name')
  .select('*')
  .eq('field', value)
```

## ğŸ§ª æµ‹è¯•ç”¨æˆ·

å®Œæˆæ•°æ®åº“è®¾ç½®åï¼Œåˆ›å»ºæµ‹è¯•ç”¨æˆ·ï¼š

```sql
-- åˆ›å»ºè¯å¸ˆç”¨æˆ·
INSERT INTO auth.users (email) VALUES ('pharmacist@test.com');
INSERT INTO profiles (id, role, store_id) 
VALUES ('user-id', 'pharmacist', 'store-001');

-- åˆ›å»ºå®¶å±ç”¨æˆ·
INSERT INTO auth.users (email) VALUES ('family@test.com');
INSERT INTO profiles (id, role, linked_family_id) 
VALUES ('user-id', 'family', 'elder-id');
```

## ğŸ“š æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 15 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **è®¤è¯**: Supabase Auth
- **éƒ¨ç½²**: Vercel (æ¨è)

## ğŸš€ éƒ¨ç½²

### Vercel éƒ¨ç½²

1. æ¨é€ä»£ç åˆ° GitHub
2. åœ¨ Vercel å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ï¼š
- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`

## ğŸ› æ•…éšœæ’æŸ¥

### ç™»å½•å¤±è´¥
- æ£€æŸ¥ `.env.local` é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ Supabase é¡¹ç›®å·²å¯åŠ¨
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### Magic Link æœªæ”¶åˆ°
- æ£€æŸ¥ Supabase é‚®ä»¶è®¾ç½®
- æŸ¥çœ‹åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹
- ç¡®è®¤é‚®ç®±åœ°å€æ­£ç¡®

### Middleware ä¸å·¥ä½œ
- ç¡®ä¿ `middleware.ts` åœ¨æ ¹ç›®å½•
- æ£€æŸ¥ matcher é…ç½®
- æŸ¥çœ‹ Next.js æ§åˆ¶å°è¾“å‡º

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**ç”± Antigravity AI åˆ›å»º** ğŸš€
